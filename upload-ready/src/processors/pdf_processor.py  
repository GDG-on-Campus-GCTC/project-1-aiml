import fitz
from PIL import Image
import io

class PDFProcessor:
    def __init__(self, dpi=150):
        """Initialize PDF processor with DPI setting"""
        self.dpi = dpi
    
    def extract_pages(self, pdf_path):
        """Extract pages from PDF as images"""
        doc = fitz.open(pdf_path)
        pages = []
        
        for page_num in range(len(doc)):
            page = doc[page_num]
            # Use DPI setting
            zoom = self.dpi / 72  # Convert DPI to zoom factor
            matrix = fitz.Matrix(zoom, zoom)
            pix = page.get_pixmap(matrix=matrix)
            
            # Convert to PIL Image
            img_data = pix.tobytes("ppm")
            img = Image.open(io.BytesIO(img_data))
            
            pages.append({
                "image": img, 
                "page_num": page_num,
                "width": img.width,
                "height": img.height
            })
        
        doc.close()
        return pages
